package com.pcs.notifications;

import android.app.Notification;
import android.app.NotificationManager;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.support.v4.app.NotificationCompat;



public class Downloader extends BroadcastReceiver{

	private Context mContext;
	private Intent mIntent;

	@Override
	public void onReceive(Context context, Intent intent) {

		mContext = context;
		mIntent = intent;

		NotificationCompat.Builder notificationBuilder = 
				new NotificationCompat.Builder(mContext);

		NotificationManager notificationManager = 
				(NotificationManager) mContext.getSystemService(Context.NOTIFICATION_SERVICE);
		
		notificationBuilder.setContentTitle(mContext.getResources().getString(R.string.download_txt));
		notificationBuilder.setContentText(mContext.getResources().getString(R.string.downloading_txt));
		
		
		new Thread(
			    new Runnable() {
			        @Override
			        public void run() {
			            int incr;

			            for (incr = 0; incr <= 100; incr+=5) {
			                    mBuilder.setProgress(100, incr, false);

			                    mNotifyManager.notify(0, mBuilder.build());
			                        try {

			                            Thread.sleep(5*1000);
			                        } catch (InterruptedException e) {
			                            Log.d(TAG, "sleep failure");
			                        }
			            }

			            mBuilder.setContentText("Download complete")

			                    .setProgress(0,0,false);
			            mNotifyManager.notify(ID, mBuilder.build());
			        }
			    }
			
			).start();

	}

}
