package com.pcs.inboxdemo;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.animation.Animation;
import android.view.animation.Animation.AnimationListener;
import android.view.animation.AnimationUtils;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;

import com.pcs.adapters.ListAdapter;

public class InboxActivity extends Activity implements AnimationListener {

	private ImageView topImg;
	private ImageView listImg;
	private ImageView img;
	private ListView listView;
	private Boolean frontIcon = true, frontImg = true;
	private Animation flipIconBack, flipContactBack, flipIconFront,
			flipContactFront;
	private String[] names = { "Avinash", "Sailika", "Dharma", "Anitha",
			"Kalyani" };
	private String[] data = { "Hi, How are you ?", "What are you doing ?",
			"Did u complete your task for today", "Tomorrow is a holiday",
			"Collect 60rs each for Bday party" };

	@Override
	protected void onCreate(Bundle savedInstanceState) {

		super.onCreate(savedInstanceState);
		setContentView(R.layout.main_layout);

		topImg = (ImageView) findViewById(R.id.not_flipped_img);
		listView = (ListView) findViewById(R.id.list_view);
		listImg = (ImageView) findViewById(R.id.list_not_flipped_img);

		flipIconBack = AnimationUtils.loadAnimation(this, R.anim.flip_back);
		flipContactBack = AnimationUtils.loadAnimation(this, R.anim.flip_back);

		flipContactFront = AnimationUtils
				.loadAnimation(this, R.anim.flip_front);
		flipIconFront = AnimationUtils.loadAnimation(this, R.anim.flip_front);

		ListAdapter adapter = new ListAdapter(getApplicationContext(), names,
				data);
		listView.setAdapter(adapter);

		flipContactBack.setAnimationListener(this);

		listView.setOnItemClickListener(new OnItemClickListener() {

			@Override
			public void onItemClick(AdapterView<?> parent, View view,
					int position, long id) {
				LinearLayout linearLayoutParent = (LinearLayout) view;

				img = (ImageView) linearLayoutParent.getChildAt(0);
				img.setOnClickListener(new OnClickListener() {
					@Override
					public void onClick(View v) {
						img.startAnimation(flipContactBack);

					}
				});

			}
		});
	}

	@Override
	public void onAnimationStart(Animation animation) {

	}

	@Override
	public void onAnimationEnd(Animation animation) {
		img.setImageResource(R.drawable.selected_img);
		img.startAnimation(flipContactFront);
		if (frontIcon) {
			topImg.startAnimation(flipIconBack);
			topImg.setImageResource(R.drawable.selected_img);
			frontIcon = false;
		}

	}

	@Override
	public void onAnimationRepeat(Animation animation) {

	}

}
